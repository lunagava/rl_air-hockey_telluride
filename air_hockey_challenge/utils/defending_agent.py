import time
import threading
import numpy as np
from scipy.interpolate import CubicSpline
from air_hockey_challenge.framework.agent_base import AgentBase
from air_hockey_challenge.utils import inverse_kinematics, world_to_robot
from baseline.baseline_agent import BezierPlanner, TrajectoryOptimizer, PuckTracker


def build_agent(env_info, **kwargs):
    """
    Function where an Agent that controls the environments should be returned.
    The Agent should inherit from the mushroom_rl Agent base env.

    Args:
        env_info (dict): The environment information
        kwargs (any): Additionally setting from agent_config.yml
    Returns:
         (AgentBase) An instance of the Agent
    """
    return DefendingAgent(env_info, **kwargs)


class DefendingAgent(AgentBase):
    def __init__(self, env_info, agent_id=1, **kwargs):
        super(DefendingAgent, self).__init__(env_info, agent_id, **kwargs)
        self.last_cmd = None
        self.joint_trajectory = None
        self.restart = True
        self.optimization_failed = False
        self.has_planned = False
        self.dt = 1 / self.env_info['robot']['control_frequency']
        self.ee_height = self.env_info['robot']["ee_desired_height"]

        self.bound_points = np.array([[-(self.env_info['table']['length'] / 2 - 0.05),
                                       -(self.env_info['table']['width'] / 2 - 0.05)],
                                      [-(self.env_info['table']['length'] / 2 - 0.05),
                                       (self.env_info['table']['width'] / 2 - 0.05)],
                                      [-0.3, (self.env_info['table']['width'] / 2 - 0.05)],
                                      [-0.3, -(self.env_info['table']['width'] / 2 - 0.05)]])
        self.bound_points = self.bound_points + np.tile([1.51, 0.], (4, 1))
        self.boundary_idx = np.array([[0, 1], [1, 2], [0, 3]])

        table_bounds = np.array([[self.bound_points[0], self.bound_points[1]],
                                 [self.bound_points[1], self.bound_points[2]],
                                 [self.bound_points[2], self.bound_points[3]],
                                 [self.bound_points[3], self.bound_points[0]]])
        self.bezier_planner = BezierPlanner(table_bounds, self.dt)
        self.optimizer = TrajectoryOptimizer(self.env_info)
        if self.env_info['robot']['n_joints'] == 3:
            self.joint_anchor_pos = np.array([-0.9273, 0.9273, np.pi / 2])
        else:
            self.joint_anchor_pos = np.array([6.28479822e-11, 7.13520517e-01, -2.96302903e-11, -5.02477487e-01,
                                              -7.67250279e-11, 1.92566224e+00, -2.34645597e-11])

        self.puck_tracker = PuckTracker(env_info, agent_id=agent_id)
        self._obs = None

    def reset(self):
        self.last_cmd = None
        self.joint_trajectory = []
        self.restart = True
        self.has_planned = False
        self.optimization_failed = False
        self._obs = None

    def move_right(self):
     joint_pos_traj = [[[-1.15725809e+00, 1.29916596e+00, 1.44277217e+00],
                        [-1.32841678e-01, -9.60446836e-02, -6.33729513e-03]],

                       [[-1.16400516e+00, 1.29445576e+00, 1.44261283e+00],
                        [-5.22191394e-01, -3.65120139e-01, -1.29431720e-02]],

                       [[-1.17785970e+00, 1.28460376e+00, 1.44210687e+00],
                        [-8.36106265e-01, -6.04811481e-01, -4.06346961e-02]],

                       [[-1.19691069e+00, 1.27041019e+00, 1.44077781e+00],
                        [-1.01725579e+00, -7.84502051e-01, -9.68734418e-02]],

                       [[-1.21808797e+00, 1.25328188e+00, 1.43798640e+00],
                        [-1.06559307e+00, -9.06007304e-01, -1.83435029e-01]],

                       [[-1.23972678e+00, 1.23384712e+00, 1.43324397e+00],
                        [-1.07518206e+00, -1.01819789e+00, -2.87566982e-01]],

                       [[-1.26151230e+00, 1.21210495e+00, 1.42630335e+00],
                        [-1.07876286e+00, -1.13272395e+00, -4.00308221e-01]],

                       [[-1.28313430e+00, 1.18815576e+00, 1.41701686e+00],
                        [-1.05235657e+00, -1.23246589e+00, -5.19645122e-01]],

                       [[-1.30369875e+00, 1.16249801e+00, 1.40527960e+00],
                        [-9.73167715e-01, -1.30012724e+00, -6.41477962e-01]],

                       [[-1.32219513e+00, 1.13583194e+00, 1.39114173e+00],
                        [-8.52420820e-01, -1.33298165e+00, -7.54856601e-01]],

                       [[-1.33806389e+00, 1.10881090e+00, 1.37490470e+00],
                        [-7.17659074e-01, -1.33624315e+00, -8.47370604e-01]],

                       [[-1.35122917e+00, 1.08199164e+00, 1.35707959e+00],
                        [-5.86206249e-01, -1.31308013e+00, -9.11199666e-01]],

                       [[-1.36180403e+00, 1.05591640e+00, 1.33828756e+00],
                        [-4.61053730e-01, -1.26209442e+00, -9.42585711e-01]],

                       [[-1.36991281e+00, 1.03117737e+00, 1.31921702e+00],
                        [-3.42624256e-01, -1.18045036e+00, -9.38060107e-01]],

                       [[-1.37573577e+00, 1.00841295e+00, 1.30063805e+00],
                        [-2.36212585e-01, -1.06661578e+00, -8.93152818e-01]],

                       [[-1.37959132e+00, 9.88275271e-01, 1.28340661e+00],
                        [-1.49019778e-01, -9.20660670e-01, -8.04347267e-01]],

                       [[-1.38191283e+00, 9.71413260e-01, 1.26842897e+00],
                        [-8.45132330e-02, -7.42274247e-01, -6.69963993e-01]],

                       [[-1.38315036e+00, 9.58475931e-01, 1.25661090e+00],
                        [-4.11644151e-02, -5.33091755e-01, -4.92845102e-01]],

                       [[-1.38368559e+00, 9.50115873e-01, 1.24881721e+00],
                        [-1.39451421e-02, -2.86339322e-01, -2.69453669e-01]],

                       [[-1.38378471e+00, 9.46978445e-01, 1.24583760e+00],
                        [2.79433005e-03, -2.80198641e-02, -2.83234971e-02]],

                       [[-1.38361436e+00, 9.48250085e-01, 1.24698793e+00],
                        [1.33398529e-02, 1.21496517e-01, 1.11244111e-01]],

                       [[-1.38325811e+00, 9.50732224e-01, 1.24922163e+00],
                        [2.20053014e-02, 9.91735414e-02, 8.56074912e-02]],

                       [[-1.38271686e+00, 9.51886692e-01, 1.25008460e+00],
                        [3.18471509e-02, 2.15583154e-02, 5.93653431e-03]],

                       [[-1.38196334e+00, 9.52036106e-01, 1.24987631e+00],
                        [4.27767843e-02, 8.11674174e-03, -1.21847798e-02]],

                       [[-1.38098876e+00, 9.52603129e-01, 1.24996778e+00],
                        [5.35323702e-02, 5.23090915e-02, 2.54637953e-02]],

                       [[-1.37980349e+00, 9.54128396e-01, 1.25088594e+00],
                        [6.36611660e-02, 9.31867699e-02, 6.01795008e-02]],

                       [[-1.37841640e+00, 9.56160714e-01, 1.25219848e+00],
                        [7.36148048e-02, 1.02964355e-01, 6.49010424e-02]],

                       [[-1.37682667e+00, 9.58194269e-01, 1.25341579e+00],
                        [8.37020014e-02, 9.84169831e-02, 5.56995914e-02]],

                       [[-1.37503297e+00, 9.60192764e-01, 1.25450182e+00],
                        [9.37504201e-02, 1.01808894e-01, 5.41644610e-02]],

                       [[-1.37303780e+00, 9.62381765e-01, 1.25567505e+00],
                        [1.03644052e-01, 1.15860033e-01, 6.29641229e-02]],

                       [[-1.37084326e+00, 9.64882182e-01, 1.25705253e+00],
                        [1.13513979e-01, 1.30759223e-01, 7.25592677e-02]],

                       [[-1.36844825e+00, 9.67631246e-01, 1.25857251e+00],
                        [1.23486348e-01, 1.40236564e-01, 7.68434133e-02]],

                       [[-1.36585094e+00, 9.70526805e-01, 1.26013498e+00],
                        [1.33505887e-01, 1.46075521e-01, 7.75667797e-02]],

                       [[-1.36305166e+00, 9.73539080e-01, 1.26171075e+00],
                        [1.43457035e-01, 1.52308354e-01, 7.86704291e-02]],

                       [[-1.36005213e+00, 9.76694125e-01, 1.26332508e+00],
                        [1.53331831e-01, 1.60051075e-01, 8.12302275e-02]],

                       [[-1.35685314e+00, 9.80009514e-01, 1.26499456e+00],
                        [1.63207594e-01, 1.67835921e-01, 8.37953900e-02]],

                       [[-1.35345411e+00, 9.83470549e-01, 1.26670410e+00],
                        [1.73122794e-01, 1.74369306e-01, 8.51048253e-02]],

                       [[-1.34985457e+00, 9.87050668e-01, 1.26842725e+00],
                        [1.83036199e-01, 1.79742303e-01, 8.52678757e-02]],

                       [[-1.34605518e+00, 9.90733597e-01, 1.27014807e+00],
                        [1.92889679e-01, 1.84650734e-01, 8.49818824e-02]],

                       [[-1.34205742e+00, 9.94514186e-01, 1.27186169e+00],
                        [2.02665575e-01, 1.89398041e-01, 8.45473985e-02]],

                       [[-1.33786276e+00, 9.98387713e-01, 1.27356366e+00],
                        [2.12375094e-01, 1.93789014e-01, 8.37734281e-02]],

                       [[-1.33347250e+00, 1.00234415e+00, 1.27524442e+00],
                        [2.22016631e-01, 1.97577392e-01, 8.24271858e-02]],

                       [[-1.32888827e+00, 1.00637069e+00, 1.27689194e+00],
                        [2.31562035e-01, 2.00742674e-01, 8.05052402e-02]],

                       [[-1.32411238e+00, 1.01045588e+00, 1.27849590e+00],
                        [2.40975219e-01, 2.03403508e-01, 7.81410553e-02]],

                       [[-1.31914778e+00, 1.01459049e+00, 1.28004844e+00],
                        [2.50230123e-01, 2.05635441e-01, 7.54220968e-02]],

                       [[-1.31399788e+00, 1.01876581e+00, 1.28154247e+00],
                        [2.59308990e-01, 2.07423433e-01, 7.23456209e-02]],

                       [[-1.30866641e+00, 1.02297245e+00, 1.28297049e+00],
                        [2.68191048e-01, 2.08729703e-01, 6.88889915e-02]],

                       [[-1.30315763e+00, 1.02720056e+00, 1.28432488e+00],
                        [2.76847860e-01, 2.09551449e-01, 6.50668112e-02]],

                       [[-1.29747642e+00, 1.03144059e+00, 1.28559869e+00],
                        [2.85247678e-01, 2.09915588e-01, 6.09236555e-02]],

                       [[-1.29162827e+00, 1.03568359e+00, 1.28678588e+00],
                        [2.93360530e-01, 2.09847137e-01, 5.65014961e-02]],

                       [[-1.28561928e+00, 1.03992093e+00, 1.28788109e+00],
                        [3.01158532e-01, 2.09356062e-01, 5.18270868e-02]],

                       [[-1.27945609e+00, 1.04414410e+00, 1.28887946e+00],
                        [3.08613334e-01, 2.08446598e-01, 4.69220390e-02]],

                       [[-1.27314594e+00, 1.04834474e+00, 1.28977657e+00],
                        [3.15694801e-01, 2.07128498e-01, 4.18140708e-02]],

                       [[-1.26669669e+00, 1.05251474e+00, 1.29056868e+00],
                        [3.22371945e-01, 2.05417964e-01, 3.65373700e-02]],

                       [[-1.26011681e+00, 1.05664634e+00, 1.29125272e+00],
                        [3.28614305e-01, 2.03332437e-01, 3.11269538e-02]],

                       [[-1.25341541e+00, 1.06073214e+00, 1.29182632e+00],
                        [3.34392311e-01, 2.00887515e-01, 2.56155451e-02]],

                       [[-1.24660215e+00, 1.06476501e+00, 1.29228777e+00],
                        [3.39676865e-01, 1.98097991e-01, 2.00347252e-02]],

                       [[-1.23968731e+00, 1.06873814e+00, 1.29263599e+00],
                        [3.44439086e-01, 1.94979892e-01, 1.44169363e-02]],

                       [[-1.23268173e+00, 1.07264508e+00, 1.29287056e+00],
                        [3.48650555e-01, 1.91550930e-01, 8.79574273e-03]],

                       [[-1.22559682e+00, 1.07647972e+00, 1.29299176e+00],
                        [3.52283723e-01, 1.87829654e-01, 3.20479652e-03]],

                       [[-1.21844454e+00, 1.08023635e+00, 1.29300054e+00],
                        [3.55312116e-01, 1.83834740e-01, -2.32296369e-03]],

                       [[-1.21123738e+00, 1.08390962e+00, 1.29289850e+00],
                        [3.57710348e-01, 1.79584991e-01, -7.75534170e-03]],

                       [[-1.20398832e+00, 1.08749458e+00, 1.29268788e+00],
                        [3.59454124e-01, 1.75099625e-01, -1.30606473e-02]],

                       [[-1.19671082e+00, 1.09098666e+00, 1.29237158e+00],
                        [3.60520337e-01, 1.70398328e-01, -1.82077149e-02]],

                       [[-1.18941881e+00, 1.09438170e+00, 1.29195310e+00],
                        [3.60887212e-01, 1.65501046e-01, -2.31661802e-02]],

                       [[-1.18212662e+00, 1.09767594e+00, 1.29143654e+00],
                        [3.60534395e-01, 1.60427760e-01, -2.79067526e-02]],

                       [[-1.17484899e+00, 1.10086603e+00, 1.29082661e+00],
                        [3.59443002e-01, 1.55198364e-01, -3.24013501e-02]],

                       [[-1.16760104e+00, 1.10394900e+00, 1.29012854e+00],
                        [3.57595639e-01, 1.49832608e-01, -3.66231618e-02]],

                       [[-1.16039820e+00, 1.10692230e+00, 1.28934811e+00],
                        [3.54976438e-01, 1.44350014e-01, -4.05467382e-02]],

                       [[-1.15325622e+00, 1.10978377e+00, 1.28849159e+00],
                        [3.51571092e-01, 1.38769737e-01, -4.41481241e-02]],

                       [[-1.14619113e+00, 1.11253161e+00, 1.28756572e+00],
                        [3.47366879e-01, 1.33110409e-01, -4.74049910e-02]],

                       [[-1.13921919e+00, 1.11516442e+00, 1.28657768e+00],
                        [3.42352663e-01, 1.27390005e-01, -5.02967416e-02]],

                       [[-1.13235686e+00, 1.11768112e+00, 1.28553503e+00],
                        [3.36518890e-01, 1.21625715e-01, -5.28045903e-02]],

                       [[-1.12562081e+00, 1.12008101e+00, 1.28444572e+00],
                        [3.29857575e-01, 1.15833818e-01, -5.49116409e-02]],

                       [[-1.11902781e+00, 1.12236368e+00, 1.28331800e+00],
                        [3.22362289e-01, 1.10029543e-01, -5.66029652e-02]],

                       [[-1.11259479e+00, 1.12452903e+00, 1.28216040e+00],
                        [3.14028142e-01, 1.04226933e-01, -5.78656782e-02]],

                       [[-1.10633873e+00, 1.12657721e+00, 1.28098171e+00],
                        [3.04851751e-01, 9.84387044e-02, -5.86890029e-02]],

                       [[-1.10027669e+00, 1.12850864e+00, 1.27979089e+00],
                        [2.94831224e-01, 9.26761215e-02, -5.90643280e-02]],

                       [[-1.09442572e+00, 1.13032393e+00, 1.27859707e+00],
                        [2.83966120e-01, 8.69488638e-02, -5.89852602e-02]],

                       [[-1.08880289e+00, 1.13202388e+00, 1.27740947e+00],
                        [2.72257431e-01, 8.12649013e-02, -5.84476750e-02]],

                       [[-1.08342523e+00, 1.13360944e+00, 1.27623739e+00],
                        [2.59707556e-01, 7.56303695e-02, -5.74497658e-02]],

                       [[-1.07830971e+00, 1.13508164e+00, 1.27509013e+00],
                        [2.46320275e-01, 7.00494501e-02, -5.59920917e-02]],

                       [[-1.07347321e+00, 1.13644160e+00, 1.27397696e+00],
                        [2.32100737e-01, 6.45242547e-02, -5.40776240e-02]],

                       [[-1.06893248e+00, 1.13769045e+00, 1.27290705e+00],
                        [2.17055448e-01, 5.90547147e-02, -5.17117947e-02]],

                       [[-1.06470414e+00, 1.13882928e+00, 1.27188947e+00],
                        [2.01192266e-01, 5.36384742e-02, -4.89025475e-02]],

                       [[-1.06080463e+00, 1.13985914e+00, 1.27093306e+00],
                        [1.84520412e-01, 4.82707883e-02, -4.56603933e-02]],

                       [[-1.05725018e+00, 1.14078093e+00, 1.27004645e+00],
                        [1.67050482e-01, 4.29444269e-02, -4.19984694e-02]],

                       [[-1.05405682e+00, 1.14159540e+00, 1.26923797e+00],
                        [1.48794480e-01, 3.76495809e-02, -3.79326095e-02]],

                       [[-1.05124029e+00, 1.14230306e+00, 1.26851560e+00],
                        [1.29765850e-01, 3.23737836e-02, -3.34814089e-02]],

                       [[-1.04881607e+00, 1.14290415e+00, 1.26788692e+00],
                        [1.09979558e-01, 2.71018044e-02, -2.86663406e-02]],

                       [[-1.04679930e+00, 1.14339857e+00, 1.26735904e+00],
                        [8.94520857e-02, 2.18156702e-02, -2.35117300e-02]],

                       [[-1.04520479e+00, 1.14378583e+00, 1.26693854e+00],
                        [6.82018017e-02, 1.64942416e-02, -1.80453039e-02]],

                       [[-1.04404695e+00, 1.14406497e+00, 1.26663145e+00],
                        [4.62480178e-02, 1.11144804e-02, -1.22966544e-02]],

                       [[-1.04333977e+00, 1.14423454e+00, 1.26644309e+00],
                        [2.36150593e-02, 5.64643979e-03, -6.30354037e-03]],

                       [[-1.04309677e+00, 1.14429251e+00, 1.26637811e+00],
                        [3.17705812e-04, 7.17201936e-05, -8.90070029e-05]]]
     return joint_pos_traj

    def move_left_avanti(self):
      joint_pos_traj = [[[-1.15480850e+00,  1.29959386e+00,  1.44170828e+00],
  [ 7.88415894e-02, -5.72227491e-02, -9.60662701e-02]],

 [[-1.15089441e+00,  1.29676125e+00,  1.43693641e+00],
  [ 3.02957642e-01, -2.19287979e-01, -3.69313385e-01]],

 [[-1.14278006e+00,  1.29087913e+00,  1.42704903e+00],
  [ 4.94399405e-01, -3.58929038e-01, -6.02175231e-01]],

 [[-1.13131405e+00,  1.28253415e+00,  1.41309181e+00],
  [ 6.25253614e-01, -4.56357516e-01, -7.60626215e-01]],

 [[-1.11789348e+00,  1.27270120e+00,  1.39677876e+00],
  [ 6.97860979e-01, -5.13322230e-01, -8.47556614e-01]],

 [[-1.10317127e+00,  1.26182559e+00,  1.37891762e+00],
  [ 7.59811225e-01, -5.63592616e-01, -9.20742167e-01]],

 [[-1.08715150e+00,  1.24989430e+00,  1.35953230e+00],
  [ 8.25134518e-01, -6.16948805e-01, -9.97008269e-01]],

 [[-1.06988646e+00,  1.23693332e+00,  1.33870464e+00],
  [ 8.79257016e-01, -6.62730330e-01, -1.05900179e+00]],

 [[-1.05178052e+00,  1.22322706e+00,  1.31693205e+00],
  [ 9.07040709e-01, -6.89662030e-01, -1.08904259e+00]],

 [[-1.03339472e+00,  1.20918340e+00,  1.29489038e+00],
  [ 9.08110414e-01, -6.96827378e-01, -1.08705135e+00]],

 [[-1.01519831e+00,  1.19515786e+00,  1.27314101e+00],
  [ 8.89474378e-01, -6.88617361e-01, -1.06152952e+00]],

 [[-9.97543800e-01,  1.18143350e+00,  1.25210369e+00],
  [ 8.54421021e-01, -6.66906965e-01, -1.01655713e+00]],

 [[-9.80780329e-01,  1.16829975e+00,  1.23218898e+00],
  [ 8.00615706e-01, -6.29611765e-01, -9.49696647e-01]],

 [[-9.65323701e-01,  1.15610231e+00,  1.21387919e+00],
  [ 7.24715915e-01, -5.73901868e-01, -8.57334772e-01]],

 [[-9.51634761e-01,  1.14522779e+00,  1.19770439e+00],
  [ 6.25846963e-01, -4.98758458e-01, -7.38624111e-01]],

 [[-9.40172445e-01,  1.13606828e+00,  1.18419028e+00],
  [ 5.04449725e-01, -4.04199947e-01, -5.94129109e-01]],

 [[-9.31378826e-01,  1.12900702e+00,  1.17384214e+00],
  [ 3.62421040e-01, -2.91672663e-01, -4.26120048e-01]],

 [[-9.25691478e-01,  1.12442308e+00,  1.16715945e+00],
  [ 1.94903258e-01, -1.57306560e-01, -2.28838185e-01]],

 [[-9.23552175e-01,  1.12269352e+00,  1.16464678e+00],
  [ 1.94743449e-02, -1.60520827e-02, -2.31565353e-02]],

 [[-9.24391818e-01,  1.12334870e+00,  1.16560878e+00],
  [-7.99256390e-02,  6.20722866e-02,  9.13378710e-02]],

 [[-9.25974494e-01,  1.12453117e+00,  1.16737529e+00],
  [-5.92543043e-02,  4.04779566e-02,  6.27277706e-02]],

 [[-9.26528602e-01,  1.12477155e+00,  1.16783770e+00],
  [-1.65036048e-04, -1.28280308e-02, -1.14678592e-02]],

 [[-9.26285043e-01,  1.12426657e+00,  1.16727508e+00],
  [ 1.38276745e-02, -2.84336630e-02, -3.17292881e-02]],

 [[-9.26241976e-01,  1.12384915e+00,  1.16688043e+00],
  [-1.26090796e-02, -1.03255326e-02, -3.67819199e-03]],

 [[-9.26780474e-01,  1.12383756e+00,  1.16710959e+00],
  [-3.69154127e-02,  6.06988202e-03,  2.18834531e-02]],

 [[-9.27589695e-01,  1.12397475e+00,  1.16759302e+00],
  [-3.97365568e-02,  4.68645923e-03,  2.18960723e-02]],

 [[-9.28321080e-01,  1.12397309e+00,  1.16791700e+00],
  [-3.27709470e-02, -4.70289553e-03,  1.03558854e-02]],

 [[-9.28953107e-01,  1.12381761e+00,  1.16805850e+00],
  [-3.15156827e-02, -9.19549600e-03,  5.75935639e-03]],

 [[-9.29646600e-01,  1.12364485e+00,  1.16821186e+00],
  [-3.78790666e-02, -7.22744977e-03,  1.03645796e-02]],

 [[-9.30490136e-01,  1.12353071e+00,  1.16848480e+00],
  [-4.50698082e-02, -4.47159952e-03,  1.60479333e-02]],

 [[-9.31445042e-01,  1.12344499e+00,  1.16883297e+00],
  [-4.87381740e-02, -4.54577356e-03,  1.76188551e-02]],

 [[-9.32445095e-01,  1.12333479e+00,  1.16917931e+00],
  [-5.01016105e-02, -6.42116004e-03,  1.65440788e-02]],

 [[-9.33473872e-01,  1.12318891e+00,  1.16950645e+00],
  [-5.19424321e-02, -7.77370505e-03,  1.61527221e-02]],

 [[-9.34553627e-01,  1.12302838e+00,  1.16984324e+00],
  [-5.50439057e-02, -7.95671701e-03,  1.73757605e-02]],

 [[-9.35701072e-01,  1.12286944e+00,  1.17021175e+00],
  [-5.84077705e-02, -7.80955460e-03,  1.90137207e-02]],

 [[-9.36910826e-01,  1.12270985e+00,  1.17060759e+00],
  [-6.11433862e-02, -8.07507747e-03,  2.00013365e-02]],

 [[-9.38169230e-01,  1.12254051e+00,  1.17101648e+00],
  [-6.33039636e-02, -8.70445216e-03,  2.04060186e-02]],

 [[-9.39469516e-01,  1.12235815e+00,  1.17143249e+00],
  [-6.53611562e-02, -9.30141152e-03,  2.07944808e-02]],

 [[-9.40812504e-01,  1.12216585e+00,  1.17185878e+00],
  [-6.75245047e-02, -9.69208931e-03,  2.14166590e-02]],

 [[-9.42199374e-01,  1.12196694e+00,  1.17229888e+00],
  [-6.96634439e-02, -9.98750366e-03,  2.21144325e-02]],

 [[-9.43627697e-01,  1.12176174e+00,  1.17275201e+00],
  [-7.16082152e-02, -1.03296982e-02,  2.26841494e-02]],

 [[-9.45093063e-01,  1.12154889e+00,  1.17321499e+00],
  [-7.33393625e-02, -1.07336407e-02,  2.31035455e-02]],

 [[-9.46591883e-01,  1.12132779e+00,  1.17368569e+00],
  [-7.49322441e-02, -1.11352358e-02,  2.34638816e-02]],

 [[-9.48121972e-01,  1.12109898e+00,  1.17416363e+00],
  [-7.64346255e-02, -1.14944175e-02,  2.38225095e-02]],

 [[-9.49681443e-01,  1.12086328e+00,  1.17464871e+00],
  [-7.78331427e-02, -1.18226386e-02,  2.41630930e-02]],

 [[-9.51267871e-01,  1.12062103e+00,  1.17514018e+00],
  [-7.90976540e-02, -1.21450285e-02,  2.44494581e-02]],

 [[-9.52878413e-01,  1.12037225e+00,  1.17563678e+00],
  [-8.02201792e-02, -1.24677379e-02,  2.46724127e-02]],

 [[-9.54510302e-01,  1.12011702e+00,  1.17613736e+00],
  [-8.12122353e-02, -1.27805609e-02,  2.48462193e-02]],

 [[-9.56161023e-01,  1.11985566e+00,  1.17664107e+00],
  [-8.20840547e-02, -1.30745861e-02,  2.49834086e-02]],

 [[-9.57828158e-01,  1.11958854e+00,  1.17714719e+00],
  [-8.28355142e-02, -1.33497065e-02,  2.50839475e-02]],

 [[-9.59509229e-01,  1.11931603e+00,  1.17765493e+00],
  [-8.34619713e-02, -1.36095425e-02,  2.51424176e-02]],

 [[-9.61201681e-01,  1.11903841e+00,  1.17816341e+00],
  [-8.39617130e-02, -1.38551516e-02,  2.51570196e-02]],

 [[-9.62902970e-01,  1.11875598e+00,  1.17867175e+00],
  [-8.43367679e-02, -1.40844297e-02,  2.51304818e-02]],

 [[-9.64610602e-01,  1.11846910e+00,  1.17917918e+00],
  [-8.45895908e-02, -1.42949621e-02,  2.50660063e-02]],

 [[-9.66322118e-01,  1.11817816e+00,  1.17968493e+00],
  [-8.47209960e-02, -1.44857510e-02 , 2.49647856e-02]],

 [[-9.68035061e-01,  1.11788357e+00,  1.18018826e+00],
  [-8.47307761e-02, -1.46566541e-02,  2.48267835e-02]],

 [[-9.69746974e-01,  1.11758573e+00,  1.18068843e+00],
  [-8.46190419e-02, -1.48072442e-02,  2.46523658e-02]],

 [[-9.71455405e-01,  1.11728506e+00,  1.18118472e+00],
  [-8.43865818e-02, -1.49365227e-02,  2.44427206e-02]],

 [[-9.73157925e-01,  1.11698199e+00,  1.18167643e+00],
  [-8.40343702e-02, -1.50433502e-02,  2.41992497e-02]],

 [[-9.74852122e-01,  1.11667701e+00,  1.18216288e+00],
  [-8.35631405e-02, -1.51268086e-02,  2.39230505e-02]],

 [[-9.76535593e-01,  1.11637058e+00,  1.18264342e+00],
  [-8.29734132e-02, -1.51861688e-02,  2.36149578e-02]],

 [[-9.78205951e-01,  1.11606320e+00,  1.18311742e+00],
  [-8.22657221e-02, -1.52206970e-02,  2.32758197e-02]],

 [[-9.79860815e-01,  1.11575538e+00,  1.18358426e+00],
  [-8.14407102e-02, -1.52295767e-02,  2.29066120e-02]],

 [[-9.81497821e-01,  1.11544764e+00,  1.18404334e+00],
  [-8.04990624e-02, -1.52119698e-02,  2.25083528e-02]],

 [[-9.83114619e-01,  1.11514054e+00,  1.18449409e+00],
  [-7.94414219e-02, -1.51670891e-02,  2.20819991e-02]],

 [[-9.84708869e-01,  1.11483462e+00,  1.18493594e+00],
  [-7.82683783e-02, -1.50942070e-02,  2.16284345e-02]],

 [[-9.86278244e-01,  1.11453047e+00,  1.18536835e+00],
  [-7.69805020e-02, -1.49926257e-02,  2.11485103e-02]],

 [[-9.87820429e-01,  1.11422867e+00,  1.18579080e+00],
  [-7.55783634e-02, -1.48616621e-02,  2.06430691e-02]],

 [[-9.89333119e-01,  1.11392982e+00,  1.18620279e+00],
  [-7.40625236e-02, -1.47006568e-02,  2.01129313e-02]],

 [[-9.90814022e-01,  1.11363453e+00,  1.18660381e+00],
  [-7.24335166e-02, -1.45089899e-02,  1.95588741e-02]],

 [[-9.92260855e-01,  1.11334343e+00,  1.18699340e+00],
  [-7.06918426e-02, -1.42860862e-02,  1.89816220e-02]],

 [[-9.93671345e-01,  1.11305715e+00,  1.18737109e+00],
  [-6.88379706e-02, -1.40314141e-02,  1.83818507e-02]],

 [[-9.95043229e-01,  1.11277635e+00,  1.18773643e+00],
  [-6.68723400e-02, -1.37444835e-02,  1.77601880e-02]],

 [[-9.96374251e-01,  1.11250168e+00,  1.18808899e+00],
  [-6.47953571e-02, -1.34248495e-02,  1.71172101e-02]],

 [[-9.97662164e-01,  1.11223381e+00,  1.18842834e+00],
  [-6.26073902e-02, -1.30721173e-02,  1.64534339e-02]],

 [[-9.98904728e-01,  1.11197340e+00,  1.18875407e+00],
  [-6.03087648e-02, -1.26859455e-02,  1.57693120e-02]],

 [[-1.00009971e+00,  1.11172114e+00,  1.18906576e+00],
  [-5.78997618e-02, -1.22660485e-02,  1.50652299e-02]],

 [[-1.00124488e+00,  1.11147771e+00,  1.18936302e+00],
  [-5.53806155e-02, -1.18121983e-02,  1.43415030e-02]],

 [[-1.00233801e+00,  1.11124380e+00,  1.18964546e+00],
  [-5.27515101e-02, -1.13242270e-02,  1.35983726e-02]],

 [[-1.00337689e+00,  1.11102010e+00,  1.18991268e+00],
  [-5.00125769e-02 ,-1.08020302e-02,  1.28360018e-02]],

 [[-1.00435929e+00,  1.11080730e+00,  1.19016429e+00],
  [-4.71638907e-02, -1.02455696e-02,  1.20544711e-02]],

 [[-1.00528299e+00,  1.11060610e+00,  1.19039991e+00],
  [-4.42054675e-02, -9.65487563e-03,  1.12537744e-02]],

 [[-1.00614578e+00,  1.11041719e+00,  1.19061915e+00],
  [-4.11372610e-02, -9.03005048e-03 , 1.04338160e-02]],

 [[-1.00694543e+00,  1.11024125e+00,  1.19082162e+00],
  [-3.79591602e-02, -8.37127034e-03,  9.59440587e-03]],

 [[-1.00767973e+00,  1.11007896e+00,  1.19100692e+00],
  [-3.46709867e-02, -7.67878843e-03,  8.73525662e-03]],

 [[-1.00834644e+00,  1.10993102e+00,  1.19117465e+00],
  [-3.12724916e-02, -6.95293784e-03,  7.85597908e-03]],

 [[-1.00894334e+00,  1.10979808e+00,  1.19132440e+00],
  [-2.77633528e-02, -6.19413436e-03,  6.95607873e-03]],

 [[-1.00946817e+00,  1.10968081e+00,  1.19145575e+00],
  [-2.41431729e-02, -5.40287909e-03,  6.03495223e-03]],

 [[-1.00991870e+00,  1.10957985e+00,  1.19156825e+00],
  [-2.04114755e-02, -4.57976226e-03,  5.09188269e-03]],

 [[-1.01029265e+00,  1.10949586e+00,  1.19166146e+00],
  [-1.65677060e-02, -3.72546274e-03,  4.12604021e-03]],

 [[-1.01058777e+00,  1.10942944e+00,  1.19173490e+00],
  [-1.26112186e-02, -2.84076382e-03,  3.13646254e-03]],

 [[-1.01080176e+00,  1.10938120e+00,  1.19178810e+00],
  [-8.54131375e-03, -1.92650857e-03,  2.12211061e-03]],

 [[-1.01093233e+00,  1.10935174e+00,  1.19182052e+00],
  [-4.35708720e-03, -9.83780982e-04,  1.08164461e-03]],

 [[-1.01097714e+00,  1.10934162e+00,  1.19183165e+00],
  [-5.79845272e-05, -1.32445156e-05,  1.42436819e-05]]]
      return joint_pos_traj


    def move_centre(self):
     joint_pos_traj = [[[-1.03103966e+00,  1.12061012e+00,  1.21744180e+00],
  [-1.56333418e-02,  2.08789220e-02,  2.61856651e-02]],

 [[-1.03111908e+00,  1.12074109e+00,  1.21759741e+00],
  [ 6.09324069e-03, -5.80228210e-03, -8.08888437e-03]],

 [[-1.03089843e+00,  1.12050750e+00,  1.21728319e+00],
  [ 1.22356907e-02, -1.29109497e-02, -1.73859660e-02]],

 [[-1.03071542e+00,  1.12033316e+00,  1.21704018e+00],
  [ 4.91345238e-03, -3.13786278e-03, -5.12401470e-03]],

 [[-1.03069359e+00,  1.12037256e+00,  1.21706582e+00],
  [-1.46762652e-03,  5.42101447e-03,  5.59965551e-03]],

 [[-1.03072610e+00,  1.12049099e+00,  1.21718836e+00],
  [-6.28560107e-04,  4.89363988e-03,  4.73234746e-03]],

 [[-1.03069796e+00,  1.12054380e+00,  1.21722326e+00],
  [ 3.33173471e-03,  4.36566197e-04, -1.14693196e-03]],

 [[-1.03060536e+00,  1.12052595e+00,  1.21716418e+00],
  [ 5.23213397e-03, -1.44736550e-03, -3.73692454e-03]],

 [[-1.03050411e+00,  1.12050720e+00,  1.21710026e+00],
  [ 4.53014632e-03, -8.21791454e-05, -2.17275651e-03]],

 [[-1.03042425e+00,  1.12052489e+00,  1.21707932e+00],
  [ 3.54576725e-03,  1.61804837e-03, -1.73734383e-04]],

 [[-1.03035313e+00,  1.12056274e+00,  1.21708074e+00],
  [ 3.71004301e-03,  1.85847715e-03, -3.16028430e-05]],

 [[-1.03026962e+00,  1.12059391e+00,  1.21707035e+00],
  [ 4.57841630e-03,  1.19860309e-03, -1.03263972e-03]],

 [[-1.03016973e+00,  1.12061303e+00,  1.21704144e+00],
  [ 5.21293268e-03,  8.15627698e-04, -1.67405610e-03]],

 [[-1.03006225e+00,  1.12063080e+00,  1.21700780e+00],
  [ 5.36699239e-03,  1.01840067e-03, -1.56135309e-03]],

 [[-1.02995381e+00,  1.12065519e+00,  1.21697971e+00],
  [ 5.38635280e-03,  1.37276156e-03, -1.24869413e-03]],

 [[-1.02984356e+00,  1.12068478e+00,  1.21695550e+00],
  [ 5.56719231e-03,  1.50720367e-03, -1.21040463e-03]],

 [[-1.02972798e+00,  1.12071482e+00,  1.21692923e+00],
  [ 5.88467711e-03,  1.45304653e-03, -1.40655231e-03]],

 [[-1.02960598e+00,  1.12074357e+00,  1.21689883e+00],
  [ 6.17827248e-03,  1.41170398e-03, -1.58000075e-03]],

 [[-1.02947899e+00,  1.12077251e+00,  1.21686628e+00],
  [ 6.38013855e-03,  1.46822846e-03, -1.62214908e-03]],

 [[-1.02934852e+00,  1.12080316e+00,  1.21683368e+00],
  [ 6.53664013e-03,  1.56444500e-03, -1.60726585e-03]],

 [[-1.02921483e+00,  1.12083550e+00,  1.21680112e+00],
  [ 6.70487975e-03,  1.62874327e-03, -1.62678104e-03]],

 [[-1.02907753e+00,  1.12086870e+00,  1.21676767e+00],
  [ 6.89021388e-03,  1.65440815e-03, -1.68926760e-03]],

 [[-1.02893653e+00,  1.12090229e+00,  1.21673286e+00],
  [ 7.06675916e-03,  1.67389126e-03, -1.75329005e-03]],

 [[-1.02879220e+00,  1.12093641e+00,  1.21669699e+00],
  [ 7.21889292e-03,  1.70678147e-03, -1.79383852e-03]],

 [[-1.02864501e+00,  1.12097129e+00,  1.21666049e+00],
  [ 7.35174502e-03,  1.74665343e-03, -1.81912002e-03]],

 [[-1.02849525e+00,  1.12100694e+00,  1.21662349e+00],
  [ 7.47568812e-03,  1.78050581e-03, -1.84573581e-03]],

 [[-1.02834304e+00,  1.12104316e+00,  1.21658589e+00],
  [ 7.59333691e-03,  1.80505647e-03, -1.87787484e-03]],

 [[-1.02818855e+00,  1.12107983e+00,  1.21654763e+00],
  [ 7.70080549e-03,  1.82517132e-03, -1.90932256e-03]],

 [[-1.02803202e+00,  1.12111690e+00,  1.21650879e+00],
  [ 7.79483796e-03,  1.84493119e-03, -1.93486885e-03]],

 [[-1.02787372e+00,  1.12115436e+00,  1.21646950e+00],
  [ 7.87574416e-03,  1.86395067e-03, -1.95500734e-03]],

 [[-1.02771391e+00,  1.12119218e+00,  1.21642983e+00],
  [ 7.94530122e-03,  1.88000388e-03, -1.97258088e-03]],

 [[-1.02755281e+00,  1.12123029e+00,  1.21638981e+00],
  [ 8.00423631e-03,  1.89217799e-03, -1.98875472e-03]],

 [[-1.02739062e+00,  1.12126860e+00,  1.21634950e+00],
  [ 8.05201776e-03,  1.90113708e-03, -2.00268045e-03]],

 [[-1.02722758e+00,  1.12130708e+00,  1.21630893e+00],
  [ 8.08800960e-03,  1.90767739e-03, -2.01334157e-03]],

 [[-1.02706394e+00,  1.12134566e+00,  1.21626818e+00],
  [ 8.11215321e-03,  1.91187289e-03, -2.02064422e-03]],

 [[-1.02689993e+00,  1.12138430e+00,  1.21622731e+00],
  [ 8.12473067e-03,  1.91337041e-03, -2.02503980e-03]],

 [[-1.02673578e+00,  1.12142294e+00,  1.21618639e+00],
  [ 8.12590559e-03, 1.91196442e-03 ,-2.02679092e-03]],

 [[-1.02657172e+00,  1.12146152e+00,  1.21614545e+00],
  [ 8.11561197e-03,  1.90773675e-03, -2.02579313e-03]],

 [[-1.02640799e+00 , 1.12149999e+00,  1.21610456e+00],
  [ 8.09372824e-03,  1.90083918e-03, -2.02185287e-03]],

 [[-1.02624481e+00,  1.12153830e+00,  1.21606379e+00],
  [ 8.06021995e-03,  1.89131469e-03, -2.01491558e-03]],

 [[-1.02608243e+00,  1.12157638e+00,  1.21602318e+00],
  [ 8.01512404e-03,  1.87911688e-03, -2.00504086e-03]],

 [[-1.02592108e+00,  1.12161420e+00,  1.21598280e+00],
  [ 7.95846962e-03,  1.86420896e-03, -1.99227596e-03]],

 [[-1.02576099e+00,  1.12165168e+00,  1.21594271e+00],
  [ 7.89024632e-03,  1.84660349e-03, -1.97660504e-03]],

 [[-1.02560239e+00,  1.12168878e+00,  1.21590297e+00],
  [ 7.81042805e-03,  1.82633283e-03, -1.95798709e-03]],

 [[-1.02544552e+00,  1.12172545e+00,  1.21586363e+00],
  [ 7.71900076e-03,  1.80341431e-03, -1.93640023e-03]],

 [[-1.02529062e+00,  1.12176162e+00,  1.21582476e+00],
  [ 7.61596446e-03,  1.77784773e-03, -1.91184503e-03]],

 [[-1.02513792e+00,  1.12179725e+00,  1.21578641e+00],
  [ 7.50132034e-03,  1.74963136e-03, -1.88432400e-03]],

 [[-1.02498765e+00,  1.12183229e+00,  1.21574865e+00],
  [ 7.37506340e-03,  1.71877122e-03, -1.85382967e-03]],

 [[-1.02484004e+00,  1.12186667e+00,  1.21571154e+00],
  [ 7.23718518e-03,  1.68527771e-03, -1.82034906e-03]],

 [[-1.02469534e+00,  1.12190036e+00,  1.21567513e+00],
  [ 7.08767883e-03,  1.64915920e-03, -1.78387172e-03]],

 [[-1.02455378e+00,  1.12193328e+00,  1.21563949e+00],
  [ 6.92654038e-03,  1.61042053e-03, -1.74439173e-03]],

 [[-1.02441559e+00,  1.12196540e+00,  1.21560468e+00],
  [ 6.75376675e-03,  1.56906543e-03, -1.70190458e-03]],

 [[-1.02428101e+00,  1.12199666e+00,  1.21557075e+00],
  [ 6.56935423e-03,  1.52509841e-03, -1.65640474e-03]],

 [[-1.02415027e+00,  1.12202700e+00,  1.21553778e+00],
  [ 6.37329871e-03,  1.47852452e-03, -1.60788597e-03]],

 [[-1.02402360e+00,  1.12205637e+00,  1.21550581e+00],
  [ 6.16559656e-03,  1.42934822e-03, -1.55634279e-03]],

 [[-1.02390125e+00,  1.12208472e+00,  1.21547492e+00],
  [ 5.94624501e-03,  1.37757292e-03, -1.50177101e-03]],

 [[-1.02378345e+00,  1.12211201e+00,  1.21544516e+00],
  [ 5.71524189e-03,  1.32320128e-03, -1.44416742e-03]],

 [[-1.02367044e+00,  1.12213816e+00,  1.21541660e+00],
  [ 5.47258539e-03,  1.26623557e-03, -1.38352925e-03]],

 [[-1.02356244e+00,  1.12216315e+00,  1.21538929e+00],
  [ 5.21827401e-03,  1.20667767e-03, -1.31985425e-03]],

 [[-1.02345970e+00,  1.12218690e+00,  1.21536330e+00],
  [ 4.95230675e-03,  1.14452883e-03, -1.25314089e-03]],

 [[-1.02336244e+00,  1.12220937e+00,  1.21533868e+00],
  [ 4.67468321e-03,  1.07978960e-03, -1.18338858e-03]],

 [[-1.02327092e+00,  1.12223050e+00,  1.21531551e+00],
  [ 4.38540361e-03,  1.01245978e-03, -1.11059761e-03]],

 [[-1.02318535e+00,  1.12225025e+00,  1.21529383e+00],
  [ 4.08446872e-03,  9.42538473e-04, -1.03476913e-03]],

 [[-1.02310598e+00,  1.12226856e+00,  1.21527372e+00],
  [ 3.77187987e-03,  8.70024110e-04, -9.55905150e-04]],

 [[-1.02303305e+00,  1.12228538e+00,  1.21525524e+00],
  [ 3.44763904e-03,  7.94914353e-04, -8.74008613e-04]],

 [[-1.02296678e+00,  1.12230066e+00,  1.21523843e+00],
  [ 3.11174884e-03,  7.17206061e-04, -7.89083451e-04]],

 [[-1.02290741e+00,  1.12231434e+00,  1.21522338e+00],
  [ 2.76421258e-03,  6.36895262e-04, -7.01134628e-04]],

 [[-1.02285518e+00,  1.12232637e+00,  1.21521013e+00],
  [ 2.40503427e-03,  5.53977136e-04, -6.10168151e-04]],

 [[-1.02281033e+00,  1.12233670e+00,  1.21519875e+00],
  [ 2.03421862e-03 , 4.68445987e-04, -5.16191110e-04]],

 [[-1.02277308e+00,  1.12234528e+00,  1.21518929e+00],
  [ 1.65177107e-03,  3.80295239e-04, -4.19211682e-04]],

 [[-1.02274367e+00,  1.12235205e+00,  1.21518183e+00],
  [ 1.25769793e-03,  2.89517281e-04, -3.19239322e-04]],

 [[-1.02272234e+00,  1.12235696e+00,  1.21517642e+00],
  [ 8.52005961e-04,  1.96103902e-04, -2.16284222e-04]],

 [[-1.02270933e+00,  1.12235996e+00,  1.21517311e+00],
  [ 4.34703905e-04,  1.00044527e-04, -1.10359505e-04]],

 [[-1.02270486e+00,  1.12236098e+00,  1.21517198e+00],
  [ 5.79710596e-06,  1.33268192e-06, -1.47320242e-06]]]
     return joint_pos_traj

    def move_left(self):
     joint_pos_traj = [[[-1.15490207e+00, 1.30024558e+00, 1.44233288e+00],
       [7.16077830e-02, -2.53689251e-04, -4.21617238e-02]],

      [[-1.15134323e+00, 1.30025045e+00, 1.44024869e+00],
       [2.77823231e-01, 3.25543473e-04, -1.62728853e-01]],

      [[-1.14381494e+00, 1.30024213e+00, 1.43582868e+00],
       [4.64911271e-01, -1.56047005e-03, -2.73601461e-01]],

      [[-1.13287754e+00, 1.30016285e+00, 1.42936527e+00],
       [6.06973768e-01, -7.10378125e-03, -3.60401611e-01]],

      [[-1.11961434e+00, 1.29992537e+00, 1.42143792e+00],
       [7.03979893e-01, -1.71037552e-02, -4.23601889e-01]],

      [[-1.10448252e+00, 1.29944820e+00, 1.41226564e+00],
       [7.97283574e-01, -3.06940159e-02, -4.86603907e-01]],

      [[-1.08736487e+00, 1.29866442e+00, 1.40174711e+00],
       [8.99926669e-01, -4.75273443e-02, -5.56506620e-01]],

      [[-1.06817152e+00, 1.29750445e+00, 1.38979892e+00],
       [9.99690003e-01, -6.80849176e-02, -6.26459948e-01]],

      [[-1.04711569e+00, 1.29588903e+00, 1.37650637e+00],
       [1.08330132e+00, -9.26209821e-02, -6.89030555e-01]],
      [[-1.02454971e+00, 1.29374284e+00, 1.36203661e+00],
       [1.15034721e+00, -1.20496023e-01, -7.43558951e-01]],

      [[-1.00074413e+00, 1.29100909e+00, 1.34652339e+00],
       [1.20722961e+00, -1.50670582e-01, -7.92918724e-01]],

      [[-9.75858623e-01, 1.28764982e+00, 1.33005148e+00],
       [1.25739062e+00, -1.82389223e-01, -8.38520211e-01]],
      [[-9.50037778e-01, 1.28363874e+00, 1.31270423e+00],
       [1.29938102e+00, -2.15183303e-01, -8.79335010e-01]],

      [[-9.23473123e-01, 1.27895954e+00, 1.29459504e+00],
       [1.33082024e+00, -2.48461493e-01, -9.13812379e-01]],

      [[-8.96385498e-01, 1.27361087e+00, 1.27586016e+00],
       [1.35134661e+00, -2.81350571e-01, -9.41323319e-01]],

      [[-8.68984517e-01, 1.26761032e+00, 1.25663951e+00],
       [1.36209982e+00, -3.12900522e-01, -9.61991131e-01]],

      [[-8.41456813e-01, 1.26099344e+00, 1.23706956e+00],
       [1.36396695e+00, -3.42298892e-01, -9.75919977e-01]],

      [[-8.13980417e-01, 1.25381064e+00, 1.21728817e+00],
       [1.35695366e+00, -3.68865355e-01, -9.82876216e-01]],

      [[-7.86737974e-01, 1.24612574e+00, 1.19743992e+00],
       [1.34074297e+00, -3.91934912e-01, -9.82485674e-01]],

      [[-7.59916354e-01, 1.23801627e+00, 1.17767608e+00],
       [1.31528386e+00, -4.10815126e-01, -9.74483000e-01]],

      [[-7.33700216e-01, 1.22957364e+00, 1.15815173e+00],
       [1.28079763e+00, -4.24840606e-01, -9.58743536e-01]],

      [[-7.08269507e-01, 1.22090188e+00, 1.13902391e+00],
       [1.23747898e+00, -4.33429308e-01, -9.35176829e-01]],

      [[-6.83802079e-01, 1.21211587e+00, 1.12045184e+00],
       [1.18533985e+00, -4.36083328e-01, -9.03651712e-01]],

      [[-6.60476915e-01, 1.20333993e+00, 1.10259780e+00],
       [1.12428081e+00, -4.32361874e-01, -8.64005960e-01]],

      [[-6.38475101e-01, 1.19470680e+00, 1.08562726e+00],
       [1.05420699e+00, -4.21872454e-01, -8.16087984e-01]],

      [[-6.17979272e-01, 1.18635652e+00, 1.06970849e+00],
       [9.75054802e-01, -4.04287982e-01, -7.59777976e-01]],

      [[-5.99173353e-01, 1.17843491e+00, 1.05501184e+00],
       [8.86751114e-01, -3.79366828e-01, -6.94982413e-01]],

      [[-5.82243046e-01, 1.17109166e+00, 1.04170933e+00],
       [7.89196287e-01, -3.46967965e-01, -6.21635261e-01]],

      [[-5.67376362e-01, 1.16447832e+00, 1.02997408e+00],
       [6.82255036e-01, -3.07043652e-01, -5.39684258e-01]],

      [[-5.54763583e-01, 1.15874609e+00, 1.01997954e+00],
       [5.65887290e-01, -2.59703657e-01, -4.49192099e-01]],

      [[-5.44596709e-01, 1.15404328e+00, 1.01189829e+00],
       [4.39795559e-01, -2.05037809e-01, -3.50041396e-01]],

      [[-5.37068720e-01, 1.15051241e+00, 1.00590060e+00],
       [3.04809170e-01, -1.43866010e-01, -2.43108658e-01]],

      [[-5.32372846e-01, 1.14828693e+00, 1.00215283e+00],
       [1.57725425e-01, -7.50286951e-02, -1.25931532e-01]],

      [[-5.30701843e-01, 1.14748762e+00, 1.00081564e+00],
       [1.05589670e-02, -5.57417685e-03, -8.91144769e-03]],

      [[-5.31573881e-01, 1.14786420e+00, 1.00147663e+00],
       [-8.12160264e-02, 3.44979086e-02, 6.10770008e-02]],

      [[-5.33427163e-01, 1.14858602e+00, 1.00281388e+00],
       [-9.07425108e-02, 3.08308002e-02, 6.15888802e-02]],

      [[-5.35067372e-01, 1.14902001e+00, 1.00382102e+00],
       [-7.50300286e-02, 1.39595310e-02, 4.10003283e-02]],

      [[-5.36662486e-01, 1.14926149e+00, 1.00464530e+00],
       [-8.99834619e-02, 1.37222505e-02, 4.66034038e-02]],

      [[-5.38877302e-01, 1.14966955e+00, 1.00585353e+00],
       [-1.31282687e-01, 2.76883532e-02, 7.46649683e-02]],

      [[-5.41943863e-01, 1.15036953e+00, 1.00764431e+00],
       [-1.69824464e-01, 4.02045704e-02, 1.00460324e-01]],

      [[-5.45629403e-01, 1.15123727e+00, 1.00982163e+00],
       [-1.92942680e-01, 4.44943672e-02, 1.13249223e-01]],

      [[-5.49684977e-01, 1.15214063e+00, 1.01217627e+00],
       [-2.08918978e-01, 4.50454939e-02, 1.20099967e-01]],

      [[-5.54085775e-01, 1.15306840e+00, 1.01469000e+00],
       [-2.28199944e-01, 4.74729862e-02, 1.29906219e-01]],

      [[-5.58927027e-01, 1.15407334e+00, 1.01744654e+00],
       [-2.51870310e-01, 5.23100237e-02, 1.43562556e-01]],

      [[-5.64251902e-01, 1.15517912e+00, 1.02048449e+00],
       [-2.75247791e-01, 5.69903220e-02, 1.57042491e-01]],

      [[-5.70017497e-01, 1.15636254e+00, 1.02376860e+00],
       [-2.95446917e-01, 5.99582920e-02, 1.67877682e-01]],

      [[-5.76163832e-01, 1.15759155e+00, 1.02724924e+00],
       [-3.13361489e-01, 6.17215204e-02, 1.76851054e-01]],

      [[-5.82665334e-01, 1.15885308e+00, 1.03090657e+00],
       [-3.30877470e-01, 6.33097732e-02, 1.85589453e-01]],

      [[-5.89522123e-01, 1.16014793e+00, 1.03474278e+00],
       [-3.48489406e-01, 6.49779220e-02, 1.94508983e-01]],

      [[-5.96729942e-01, 1.16147418e+00, 1.03875607e+00],
       [-3.65501072e-01, 6.63352394e-02, 2.02997862e-01]],

      [[-6.04269485e-01, 1.16282166e+00, 1.04293151e+00],
       [-3.81316043e-01, 6.70618191e-02, 2.10540776e-01]],

      [[-6.12116085e-01, 1.16417753e+00, 1.04724965e+00],
       [-3.95982654e-01, 6.71997286e-02, 2.17188718e-01]],

      [[-6.20249886e-01, 1.16553185e+00, 1.05169541e+00],
       [-4.09822060e-01, 6.69372981e-02, 2.23228167e-01]],

      [[-6.28656103e-01, 1.16687766e+00, 1.05625817e+00],
       [-4.22970230e-01, 6.63553612e-02, 2.28779414e-01]],

      [[-6.37320077e-01, 1.16820819e+00, 1.06092749e+00],
       [-4.35334595e-01, 6.54096553e-02, 2.33762382e-01]],

      [[-6.46224679e-01, 1.16951548e+00, 1.06569078e+00],
       [-4.46800981e-01, 6.40496885e-02, 2.38081682e-01]],

      [[-6.55351484e-01, 1.17079119e+00, 1.07053446e+00],
       [-4.57358728e-01, 6.22865177e-02, 2.41736222e-01]],

      [[-6.64682658e-01, 1.17202761e+00, 1.07544566e+00],
       [-4.67060026e-01, 6.01664736e-02, 2.44780760e-01]],

      [[-6.74201325e-01, 1.17321796e+00, 1.08041249e+00],
       [-4.75937177e-01, 5.77239174e-02, 2.47251509e-01]],

      [[-6.83890815e-01, 1.17435586e+00, 1.08542343e+00],
       [-4.83981501e-01, 5.49709426e-02, 2.49148355e-01]],

      [[-6.93734107e-01, 1.17543512e+00, 1.09046679e+00],
       [-4.91174102e-01, 5.19159630e-02, 2.50463430e-01]],

      [[-7.03713943e-01, 1.17644982e+00, 1.09553087e+00],
       [-4.97511806e-01, 4.85780277e-02, 2.51204334e-01]],

      [[-7.13813160e-01, 1.17739452e+00, 1.10060428e+00],
       [-5.03004844e-01, 4.49844661e-02, 2.51391331e-01]],

      [[-7.24014816e-01, 1.17826432e+00, 1.10567604e+00],
       [-5.07662794e-01, 4.11624161e-02, 2.51044252e-01]],

      [[-7.34302097e-01, 1.17905488e+00, 1.11073553e+00],
       [-5.11488740e-01, 3.71357107e-02, 2.50177359e-01]],

      [[-7.44658213e-01, 1.17976229e+00, 1.11577238e+00],
       [-5.14483398e-01, 3.29275002e-02, 2.48803368e-01]],

      [[-7.55066411e-01, 1.18038313e+00, 1.12077651e+00],
       [-5.16650138e-01, 2.85630173e-02, 2.46938041e-01]],
      [[-7.65510043e-01, 1.18091452e+00, 1.12573818e+00],
       [-5.17995479e-01, 2.40695196e-02, 2.44600424e-01]],

      [[-7.75972604e-01, 1.18135414e+00, 1.13064807e+00],
       [-5.18526874e-01, 1.94747575e-02, 2.41810639e-01]],

      [[-7.86437736e-01, 1.18170022e+00, 1.13549726e+00],
       [-5.18251386e-01, 1.48061300e-02, 2.38588631e-01]],

      [[-7.96889224e-01, 1.18195155e+00, 1.14027721e+00],
       [-5.17176155e-01, 1.00909214e-02, 2.34954613e-01]],

      [[-8.07311003e-01, 1.18210747e+00, 1.14497983e+00],
       [-5.15309314e-01, 5.35672569e-03, 2.30929881e-01]],

      [[-8.17687188e-01, 1.18216787e+00, 1.14959746e+00],
       [-5.12660231e-01, 6.31416321e-04, 2.26536942e-01]],

      [[-8.28002092e-01, 1.18213321e+00, 1.15412289e+00],
       [-5.09239181e-01, -4.05720392e-03, 2.21799103e-01]],

      [[-8.38240242e-01, 1.18200451e+00, 1.15854941e+00],
       [-5.05057054e-01, -8.68168540e-03, 2.16740133e-01]],

      [[-8.48386389e-01, 1.18178334e+00, 1.16287078e+00],
       [-5.00125366e-01, -1.32150183e-02, 2.11384213e-01]],

      [[-8.58425527e-01, 1.18147180e+00, 1.16708124e+00],
       [-4.94456375e-01, -1.76306565e-02, 2.05755997e-01]],

      [[-8.68342903e-01, 1.18107255e+00, 1.17117556e+00],
       [-4.88063112e-01, -2.19026070e-02, 1.99880557e-01]],

      [[-8.78124035e-01, 1.18058873e+00, 1.17514900e+00],
       [-4.80959279e-01, -2.60055821e-02, 1.93783218e-01]],

      [[-8.87754722e-01, 1.18002399e+00, 1.17899734e+00],
       [-4.73159131e-01, -2.99151470e-02, 1.87489381e-01]],

      [[-8.97221058e-01, 1.17938250e+00, 1.18271686e+00],
       [-4.64677395e-01, -3.36078292e-02, 1.81024380e-01]],

      [[-9.06509437e-01, 1.17866884e+00, 1.18630437e+00],
       [-4.55529201e-01, -3.70612086e-02, 1.74413373e-01]],

      [[-9.15606560e-01, 1.17788808e+00, 1.18975718e+00],
       [-4.45729998e-01, -4.02540111e-02, 1.67681197e-01]],

      [[-9.24499447e-01, 1.17704566e+00, 1.19307308e+00],
       [-4.35295434e-01, -4.31662090e-02, 1.60852211e-01]],

      [[-9.33175429e-01, 1.17614746e+00, 1.19625035e+00],
       [-4.24241225e-01, -4.57791181e-02, 1.53950118e-01]],

      [[-9.41622158e-01, 1.17519967e+00, 1.19928776e+00],
       [-4.12583020e-01, -4.80754826e-02, 1.46997800e-01]],

      [[-9.49827598e-01, 1.17420887e+00, 1.20218452e+00],
       [-4.00336261e-01, -5.00395501e-02, 1.40017149e-01]],

      [[-9.57780023e-01, 1.17318189e+00, 1.20494025e+00],
       [-3.87516037e-01, -5.16571427e-02, 1.33028902e-01]],

      [[-9.65468004e-01, 1.17212586e+00, 1.20755502e+00],
       [-3.74136930e-01, -5.29157231e-02, 1.26052459e-01]],

      [[-9.72880402e-01, 1.17104815e+00, 1.21002924e+00],
       [-3.60212851e-01, -5.38044567e-02, 1.19105716e-01]],

      [[-9.80006351e-01, 1.16995631e+00, 1.21236367e+00],
       [-3.45756875e-01, -5.43142675e-02, 1.12204885e-01]],

      [[-9.86835238e-01, 1.16885806e+00, 1.21455940e+00],
       [-3.30781075e-01, -5.44378887e-02, 1.05364327e-01]],

      [[-9.93356682e-01, 1.16776126e+00, 1.21661776e+00],
       [-3.15296356e-01, -5.41699094e-02, 9.85963840e-02]],

      [[-9.99560509e-01, 1.16667386e+00, 1.21854033e+00],
       [-2.99312289e-01, -5.35068190e-02, 9.19112123e-02]],

      [[-1.00543672e+00, 1.16560384e+00, 1.22032886e+00],
       [-2.82836945e-01, -5.24470493e-02, 8.53166236e-02]],

      [[-1.01097548e+00, 1.16455922e+00, 1.22198523e+00],
       [-2.65876731e-01, -5.09910155e-02, 7.88179280e-02]],

      [[-1.01616703e+00, 1.16354797e+00, 1.22351143e+00],
       [-2.48436242e-01, -4.91411567e-02, 7.24177839e-02]],

      [[-1.02100173e+00, 1.16257799e+00, 1.22490943e+00],
       [-2.30518106e-01, -4.69019775e-02, 6.61160526e-02]],

      [[-1.02546993e+00, 1.16165709e+00, 1.22618120e+00],
       [-2.12122844e-01, -4.42800915e-02, 5.99096602e-02]],

      [[-1.02956198e+00, 1.16079291e+00, 1.22732860e+00],
       [-1.93248741e-01, -4.12842679e-02, 5.37924647e-02]],

      [[-1.03326820e+00, 1.15999287e+00, 1.22835336e+00],
       [-1.73891723e-01, -3.79254823e-02, 4.77551309e-02]],

      [[-1.03657876e+00, 1.15926419e+00, 1.22925695e+00],
       [-1.54045249e-01, -3.42169745e-02, 4.17850099e-02]],

      [[-1.03948371e+00, 1.15861377e+00, 1.23004058e+00],
       [-1.33700221e-01, -3.01743041e-02, 3.58660358e-02]],

      [[-1.04197286e+00, 1.15804817e+00, 1.23070509e+00],
       [-1.12844886e-01, -2.58154472e-02, 2.99785902e-02]],

      [[-1.04403577e+00, 1.15757358e+00, 1.23125088e+00],
       [-9.14648524e-02, -2.11607757e-02, 2.40995286e-02]],

      [[-1.04566168e+00, 1.15719574e+00, 1.23167787e+00],
       [-6.95427425e-02, -1.62335169e-02, 1.82016364e-02]],

      [[-1.04683946e+00, 1.15691989e+00, 1.23198536e+00],
       [-4.70593047e-02, -1.10584660e-02, 1.22552601e-02]],

      [[-1.04755753e+00, 1.15675076e+00, 1.23217203e+00],
       [-2.39891773e-02, -5.66726779e-03, 6.22186260e-03]],

      [[-1.04780386e+00, 1.15669243e+00, 1.23223580e+00],
       [-3.16707722e-04, -7.92377430e-05, 7.77690099e-05]]]
     return joint_pos_traj

    def move_right_avanti(self):
        joint_pos_traj =  [[[-1.15579374e+00,  1.29985221e+00,  1.44251244e+00],
  [-7.44616503e-03, -3.50504374e-02, -2.62999381e-02]],

 [[-1.15617689e+00,  1.29811041e+00,  1.44121462e+00],
  [-2.99955203e-02, -1.36505296e-01, -1.01737597e-01]],

 [[-1.15698037e+00,  1.29439759e+00,  1.43843861e+00],
  [-4.91430542e-02, -2.30576443e-01, -1.72935924e-01]],

 [[-1.15811033e+00,  1.28894840e+00,  1.43432960e+00],
  [-6.11282176e-02, -3.04495939e-01, -2.31010180e-01]],

 [[-1.15939130e+00,  1.28225757e+00,  1.42921047e+00],
  [-6.50906784e-02, -3.57873406e-01, -2.76170218e-01]],

 [[-1.16071388e+00,  1.27452234e+00,  1.42318288e+00],
  [-6.59173152e-02, -4.10608244e-01, -3.22940104e-01]],

 [[-1.16203893e+00,  1.26566183e+00,  1.41614612e+00],
  [-6.52073384e-02, -4.69139885e-01, -3.76044768e-01]],

 [[-1.16332049e+00,  1.25560490e+00,  1.40800381e+00],
  [-6.11178253e-02, -5.27747539e-01, -4.31526415e-01]],

 [[-1.16446769e+00,  1.24442345e+00,  1.39876014e+00],
  [-5.17199667e-02, -5.80141855e-01, -4.84884111e-01]],

 [[-1.16537135e+00,  1.23225488e+00,  1.38846871e+00],
  [-3.71690516e-02, -6.26168437e-01, -5.35760769e-01]],

 [[-1.16594048e+00 , 1.21919659e+00,  1.37716084e+00],
  [-1.87561238e-02, -6.68940885e-01, -5.86048537e-01]],

 [[-1.16610676e+00,  1.20529172e+00,  1.36483498e+00],
  [ 2.76423130e-03, -7.10185962e-01, -6.36743311e-01]],

 [[-1.16580763e+00,  1.19057424e+00,  1.35148695e+00],
  [ 2.74683971e-02, -7.49320880e-01, -6.87252986e-01]],

 [[-1.16497698e+00,  1.17509829e+00,  1.33713106e+00],
  [ 5.54725298e-02, -7.85312196e-01, -7.36588837e-01]],

 [[-1.16355118e+00,  1.15893027e+00,  1.32179656e+00],
  [ 8.64003280e-02, -8.18052905e-01, -7.84322101e-01]],

 [[-1.16147793e+00,  1.14213024e+00,  1.30551557e+00],
  [ 1.19585861e-01, -8.48122839e-01 ,-8.30506525e-01]],

 [[-1.15871767e+00,  1.12474662e+00,  1.28831855e+00],
  [ 1.54482805e-01, -8.75983285e-01, -8.75178632e-01]],

 [[-1.15523952e+00,  1.10682280e+00,  1.27023762e+00],
  [ 1.90757817e-01, -9.01690766e-01, -9.18139060e-01]],

 [[-1.15101855e+00,  1.08840323e+00,  1.25131036e+00],
  [ 2.28114502e-01, -9.25149137e-01, -9.59083977e-01]],

 [[-1.14603671e+00,  1.06953341e+00,  1.23157998e+00],
  [ 2.66162691e-01, -9.46373831e-01, -9.97781865e-01]],

 [[-1.14028453e+00,  1.05025712e+00,  1.21109320e+00],
  [ 3.04458235e-01, -9.65496951e-01, -1.03410246e+00]],

 [[-1.13376121e+00,  1.03061541e+00,  1.18989896e+00],
  [ 3.42598498e-01, -9.82637408e-01, -1.06794432e+00]],

 [[-1.12647336e+00,  1.01064773e+00,  1.16804844e+00],
  [ 3.80248700e-01, -9.97831474e-01, -1.09917992e+00]],

 [[-1.11843395e+00 , 9.90393475e-01,  1.14559571e+00],
  [ 4.17102455e-01, -1.01106013e+00, -1.12765890e+00]],

 [[-1.10966217e+00,  9.69892570e-01,  1.12259785e+00],
  [ 4.52847102e-01, -1.02229533e+00, -1.15323328e+00]],

 [[-1.10018357e+00,  9.49185480e-01,  1.09911481e+00],
  [ 4.87166458e-01, -1.03150822e+00, -1.17576544e+00]],

 [[-1.09002997e+00,  9.28313422e-01,  1.07520933e+00],
  [ 5.19758327e-01, -1.03864908e+00, -1.19511574e+00]],

 [[-1.07923909e+00,  9.07318975e-01,  1.05094710e+00],
  [ 5.50338060e-01, -1.04363138e+00, -1.21112724e+00]],

 [[-1.06785432e+00,  8.86246847e-01,  1.02639721e+00],
  [ 5.78626570e-01, -1.04633178e+00, -1.22361877e+00]],

 [[-1.05592470e+00,  8.65144551e-01,  1.00163268e+00],
  [ 6.04337781e-01, -1.04659575e+00, -1.23238373e+00]],

 [[-1.04350518e+00,  8.44063024e-01,  9.76730940e-01],
  [ 6.27173780e-01, -1.04423803e+00, -1.23718774e+00]],

 [[-1.03065684e+00,  8.23057284e-01,  9.51774496e-01],
  [ 6.46823830e-01, -1.03903758e+00, -1.23776279e+00]],

 [[-1.01744718e+00,  8.02187216e-01,  9.26851647e-01],
  [ 6.62961045e-01, -1.03073194e+00, -1.23380001e+00]],

 [[-1.00395050e+00,  7.81518444e-01,  9.02057382e-01],
  [ 6.75235937e-01, -1.01901406e+00 ,-1.22494371e+00]],

 [[-9.90248427e-01,  7.61123245e-01,  8.77494375e-01],
  [ 6.83270030e-01, -1.00353070e+00, -1.21078723e+00]],

 [[-9.76430554e-01,  7.41081495e-01,  8.53274031e-01],
  [ 6.86651950e-01, -9.83881109e-01, -1.19087009e+00]],

 [[-9.62595109e-01,  7.21481639e-01,  8.29517601e-01],
  [ 6.84935989e-01, -9.59615893e-01, -1.16467631e+00]],

 [[-9.48849649e-01,  7.02421667e-01,  8.06357294e-01],
  [ 6.77642657e-01, -9.30237715e-01, -1.13163512e+00]],

 [[-9.35311718e-01,  6.84010051e-01,  7.83937342e-01],
  [ 6.64261916e-01, -8.95205418e-01, -1.09112575e+00]],

 [[-9.22109385e-01 , 6.66366544e-01,  7.62414913e-01],
  [ 6.44261049e-01, -8.53942956e-01, -1.04248806e+00]],

 [[-9.09381576e-01,  6.49622743e-01,  7.41960737e-01],
  [ 6.17099037e-01, -8.05854296e-01, -9.85040723e-01]],

 [[-8.97278021e-01,  6.33922278e-01 , 7.22759264e-01],
  [ 5.82249827e-01, -7.50346654e-01, -9.18109656e-01]],

 [[-8.85958648e-01,  6.19420444e-01,  7.05008152e-01],
  [ 5.39233359e-01, -6.86861180e-01, -8.41065392e-01]],

 [[-8.75592215e-01,  6.06283075e-01,  6.88916830e-01],
  [ 4.87664538e-01, -6.14922057e-01, -7.53382927e-01]],

 [[-8.66353965e-01,  5.94684446e-01,  6.74703888e-01],
  [ 4.27285314e-01, -5.34167109e-01, -6.54677286e-01]],

 [[-8.58422106e-01,  5.84804012e-01,  6.62593061e-01],
  [ 3.58106537e-01, -4.44494061e-01, -5.44884819e-01]],

 [[-8.51973027e-01,  5.76821880e-01,  6.52807696e-01],
  [ 2.80172110e-01, -3.45806410e-01, -4.23936931e-01]],

 [[-8.47175268e-01,  5.70913058e-01,  6.45563760e-01],
  [ 1.94734494e-01, -2.39254198e-01, -2.93327423e-01]],

 [[-8.44182514e-01,  5.67240747e-01,  6.41061710e-01],
  [ 1.00118272e-01, -1.22849358e-01, -1.50556091e-01]],

 [[-8.43126121e-01,  5.65949202e-01,  6.39477848e-01],
  [ 7.30551157e-03, -7.97011019e-03, -1.00319318e-02]],

 [[-8.43571003e-01,  5.66586331e-01,  6.40233957e-01],
  [-3.83475416e-02,  5.73526475e-02,  6.75141587e-02]],

 [[-8.44220630e-01,  5.67782529e-01,  6.41593284e-01],
  [-1.67782718e-02,  5.13585558e-02,  5.47522091e-02]],

 [[-8.44120491e-01,  5.68518142e-01,  6.42266890e-01],
  [ 2.36968111e-02,  2.46666295e-02,  1.59774483e-02]],

 [[-8.43444414e-01,  5.68962117e-01,  6.42473321e-01],
  [ 3.74919213e-02,  2.54976131e-02,  1.22874534e-02]],

 [[-8.42757609e-01,  5.69700883e-01,  6.42959128e-01],
  [ 2.91323093e-02,  4.93347281e-02,  3.78777738e-02]],

 [[-8.42255346e-01,  5.70934454e-01,  6.43979639e-01],
  [ 2.29121497e-02,  7.06471996e-02,  6.03415294e-02]],

 [[-8.41751266e-01,  5.72460248e-01,  6.45279691e-01],
  [ 2.89629822e-02,  7.86700538e-02,  6.60558547e-02]],

 [[-8.41053147e-01,  5.74067421e-01,  6.46594358e-01],
  [ 4.01231120e-02,  8.08580054e-02,  6.45053046e-02]],

 [[-8.40157097e-01,  5.75742563e-01,  6.47909391e-01],
  [ 4.77569479e-02,  8.63064388e-02,  6.72223418e-02]],

 [[-8.39155900e-01,  5.77574802e-01,  6.49340293e-01],
  [ 5.11595176e-02,  9.58146576e-02,  7.52004176e-02]],

 [[-8.38095798e-01,  5.79605324e-01,  6.50941416e-01],
  [ 5.43263057e-02,  1.05213757e-01,  8.31413248e-02]],

 [[-8.36951088e-01,  5.81799839e-01,  6.52671348e-01],
  [ 5.96112229e-02,  1.12015750e-01,  8.78952662e-02]],

 [[-8.35683465e-01,  5.84110315e-01,  6.54471430e-01],
  [ 6.61838651e-02,  1.17065868e-01,  9.05436275e-02]],

 [[-8.34284463e-01,  5.86519681e-01,  6.56322390e-01],
  [ 7.24471586e-02,  1.22033356e-01,  9.32053636e-02]],

 [[-8.32766845e-01,  5.89033216e-01,  6.58233271e-01],
  [ 7.80205153e-02,  1.27328440e-01,  9.63968681e-02]],

 [[-8.31139019e-01,  5.91651863e-01,  6.60207540e-01],
  [ 8.35127779e-02,  1.32321420e-01,  9.93173711e-02]],

 [[-8.29396663e-01,  5.94363265e-01,  6.62231808e-01],
  [ 8.94115692e-02,  1.36497049e-01,  1.01315962e-01]],

 [[-8.27531471e-01,  5.97150722e-01,  6.64287251e-01],
  [ 9.56441560e-02,  1.39920621e-01,  1.02479768e-01]],

 [[-8.25539768e-01,  6.00002180e-01,  6.66361013e-01],
  [ 1.01917741e-01,  1.42891123e-01,  1.03190754e-01]],

 [[-8.23422430e-01,  6.02910259e-01 , 6.68446203e-01],
  [ 1.08110197e-01,  1.45534106e-01,  1.03609376e-01]],

 [[-8.21180547e-01,  6.05867772e-01,  6.70536200e-01],
  [ 1.14293522e-01,  1.47772528e-01,  1.03639476e-01]],

 [[-8.18813335e-01,  6.08865506e-01,  6.72621856e-01],
  [ 1.20548974e-01,  1.49516418e-01,  1.03169776e-01]],

 [[-8.16319305e-01,  6.11893378e-01,  6.74692989e-01],
  [ 1.26863412e-01,  1.50772010e-01,  1.02211649e-01]],

 [[-8.13697922e-01,  6.14942154e-01,  6.76740557e-01],
  [ 1.33170933e-01,  1.51600877e-01,  1.00846400e-01]],

 [[-8.10949862e-01,  6.18003729e-01,  6.78757014e-01],
  [ 1.39425935e-01,  1.52044694e-01,  9.91297132e-02]],

 [[-8.08076327e-01,  6.21070432e-01,  6.80735420e-01],
  [ 1.45618644e-01,  1.52108122e-01,  9.70703654e-02]],

 [[-8.05078581e-01,  6.24134543e-01,  6.82668833e-01],
  [ 1.51746174e-01,  1.51787959e-01,  9.46674429e-02]],

 [[-8.01958089e-01,  6.27188417e-01,  6.84550471e-01],
  [ 1.57790444e-01 , 1.51096180e-01,  9.19394306e-02]],

 [[-7.98716821e-01,  6.30224795e-01,  6.86374109e-01],
  [ 1.63721879e-01,  1.50056744e-01,  8.89199165e-02]],

 [[-7.95357347e-01,  6.33236909e-01,  6.88134206e-01],
  [ 1.69512485e-01,  1.48692371e-01,  8.56407504e-02]],

 [[-7.91882732e-01,  6.36218382e-01,  6.89825780e-01],
  [ 1.75140585e-01,  1.47019495e-01,  8.21257081e-02]],

 [[-7.88296449e-01,  6.39163136e-01,  6.91444282e-01],
  [ 1.80586704e-01,  1.45052319e-01,  7.83956879e-02]],

 [[-7.84602379e-01,  6.42065399e-01,  6.92985611e-01],
  [ 1.85829214e-01,  1.42807328e-01,  7.44743870e-02]],

 [[-7.80804864e-01,  6.44919756e-01,  6.94446175e-01],
  [ 1.90844338e-01,  1.40303449e-01,  7.03884393e-02]],

 [[-7.76908730e-01,  6.47721185e-01,  6.95822927e-01],
  [ 1.95608422e-01,  1.37559830e-01,  6.61645580e-02]],

 [[-7.72919265e-01,  6.50465034e-01,  6.97113343e-01],
  [ 2.00099140e-01,  1.34594605e-01 , 6.18279659e-02]],

 [[-7.68842197e-01,  6.53147015e-01,  6.98315396e-01],
  [ 2.04295022e-01,  1.31425346e-01,  5.74029736e-02]],

 [[-7.64683687e-01,  6.55763192e-01,  6.99427549e-01],
  [ 2.08174685e-01,  1.28069869e-01,  5.29139829e-02]],

 [[-7.60450326e-01,  6.58309994e-01,  7.00448760e-01],
  [ 2.11716747e-01,  1.24546368e-01,  4.83856305e-02]],

 [[-7.56149132e-01,  6.60784216e-01,  7.01378482e-01],
  [ 2.14900233e-01,  1.20873035e-01,  4.38422902e-02]],

 [[-7.51787540e-01,  6.63183020e-01,  7.02216653e-01],
  [ 2.17704883e-01,  1.17067757e-01,  3.93076889e-02]],

 [[-7.47373386e-01,  6.65503922e-01,  7.02963683e-01],
  [ 2.20111147e-01 , 1.13148119e-01,  3.48049013e-02]],

 [[-7.42914895e-01,  6.67744792e-01,  7.03620442e-01],
  [ 2.22100083e-01,  1.09131504e-01,  3.03564777e-02]],

 [[-7.38420665e-01 , 6.69903849e-01,  7.04188248e-01],
  [ 2.23653359e-01,  1.05035099e-01,  2.59844490e-02]],

 [[-7.33899661e-01,  6.71979656e-01,  7.04668859e-01],
  [ 2.24753346e-01,  1.00875800e-01,  2.17102049e-02]],

 [[-7.29361190e-01,  6.73971110e-01,  7.05064456e-01],
  [ 2.25383211e-01,  9.66701072e-02,  1.75543699e-02]],

 [[-7.24814895e-01,  6.75877440e-01,  7.05377626e-01],
  [ 2.25526958e-01,  9.24340712e-02,  1.35367425e-02]],

 [[-7.20270730e-01,  6.77698191e-01,  7.05611348e-01],
  [ 2.25169439e-01,  8.81832613e-02,  9.67626675e-03]],

 [[-7.15738947e-01 , 6.79433218e-01,  7.05768975e-01],
  [ 2.24296379e-01,  8.39327198e-02,  5.99098793e-03]],

 [[-7.11230075e-01,  6.81082674e-01,  7.05854212e-01],
  [ 2.22894422e-01,  7.96968952e-02,  2.49798449e-03]],

 [[-7.06754906e-01,  6.82646994e-01,  7.05871100e-01],
  [ 2.20951172e-01,  7.54895696e-02, -7.86705008e-04]],

 [[-7.02324468e-01,  6.84126887e-01,  7.05823991e-01],
  [ 2.18455235e-01,  7.13237903e-02, -3.84814571e-03]],

 [[-6.97950011e-01,  6.85523315e-01,  7.05717526e-01],
  [ 2.15396243e-01,  6.72118058e-02, -6.67256384e-03]],

 [[-6.93642982e-01,  6.86837479e-01,  7.05556613e-01],
  [ 2.11764891e-01,  6.31649978e-02, -9.24740640e-03]],

 [[-6.89415006e-01,  6.88070799e-01,  7.05346400e-01],
  [ 2.07552972e-01,  5.91938076e-02, -1.15614059e-02]],

 [[-6.85277860e-01,  6.89224897e-01,  7.05092247e-01],
  [ 2.02753412e-01,  5.53076598e-02, -1.36046474e-02]],

 [[-6.81243454e-01,  6.90301574e-01,  7.04799702e-01],
  [ 1.97360313e-01,  5.15148844e-02, -1.53686358e-02]],

 [[-6.77323803e-01,  6.91302786e-01,  7.04474468e-01],
  [ 1.91368984e-01,  4.78226389e-02, -1.68463618e-02]],

 [[-6.73531006e-01,  6.92230622e-01,  7.04122373e-01],
  [ 1.84775982e-01,  4.42368288e-02, -1.80323701e-02]],

 [[-6.69877217e-01,  6.93087275e-01,  7.03749342e-01],
  [ 1.77579155e-01,  4.07620253e-02, -1.89228296e-02]],

 [[-6.66374620e-01,  6.93875019e-01,  7.03361357e-01],
  [ 1.69777685e-01,  3.74013835e-02, -1.95156042e-02]],

 [[-6.63035402e-01,  6.94596174e-01,  7.02964426e-01],
  [ 1.61372129e-01,  3.41565580e-02, -1.98103263e-02]],

 [[-6.59871725e-01,  6.95253078e-01,  7.02564546e-01],
  [ 1.52364471e-01,  3.10276198e-02, -1.98084703e-02]],

 [[-6.56895697e-01,  6.95848056e-01,  7.02167667e-01],
  [ 1.42758170e-01,  2.80129722e-02, -1.95134281e-02]],

 [[-6.54119337e-01,  6.96383379e-01,  7.01779649e-01],
  [ 1.32558212e-01,  2.51092680e-02, -1.89305863e-02]],

 [[-6.51554553e-01,  6.96861237e-01,  7.01406221e-01],
  [ 1.21771167e-01,  2.23113257e-02, -1.80674041e-02]],

 [[-6.49213100e-01,  6.97283693e-01,  7.01052944e-01],
  [ 1.10405243e-01,  1.96120489e-02, -1.69334934e-02]],

 [[-6.47106552e-01,  6.97652647e-01,  7.00725159e-01],
  [ 9.84703547e-02,  1.70023446e-02, -1.55407017e-02]],

 [[-6.45246266e-01,  6.97969798e-01,  7.00427947e-01],
  [ 8.59781772e-02,  1.44710505e-02, -1.39031881e-02]],

 [[-6.43643345e-01,  6.98236595e-01,  7.00166080e-01],
  [ 7.29422375e-02,  1.20048382e-02, -1.20375333e-02]],

 [[-6.42308598e-01,  6.98454197e-01,  6.99943968e-01],
  [ 5.93779098e-02,  9.58822005e-03, -9.96273026e-03]],

 [[-6.41252507e-01,  6.98623429e-01,  6.99765615e-01],
  [ 4.53027743e-02,  7.20318136e-03, -7.70062742e-03]],

 [[-6.40485180e-01,  6.98744729e-01,  6.99634560e-01],
  [ 3.07356416e-02,  4.83022689e-03, -5.27469339e-03]],

 [[-6.40016311e-01,  6.98818108e-01,  6.99553825e-01],
  [ 1.57005792e-02,  2.44416531e-03, -2.71505224e-03]],

 [[-6.39855138e-01,  6.98843092e-01,  6.99525857e-01],
  [ 2.12292428e-04,  2.95510427e-05, -4.01295803e-05]]]
        return joint_pos_traj

    def draw_action(self, obs, action):
       ## CODICE DI MGE
       if self.restart:
           self.restart = False
           print("draw_action, obs: ", obs)
           puck_pos = self.get_puck_pos(obs)
           print("draw_action, puck pos: ", puck_pos)
           puck_vel = self.get_puck_vel(obs)
           print("draw_action, puck vel: ", puck_vel)
           joint_pos = self.get_joint_pos(obs)
           print("draw_action, joint_pos: ", joint_pos)
           joint_vel = self.get_joint_vel(obs)
           print("draw_action, joint_vel: ", joint_vel)
           ee_pos, _ = self.get_ee_pose(obs)
           print("draw_action, ee_pos:", ee_pos)


           self.last_cmd = np.vstack([joint_pos, joint_vel])
           if action == 2:
               joint_pos_traj = [[ee_pos], [0,0,0]]
           else:
            if action == 0: ## move right
               joint_pos_traj = self.move_right()

            elif action ==4: ## a sinistra in avanti
             joint_pos_traj = self.move_left_avanti()
            elif action ==3: ## Move in the centre
             joint_pos_traj =  self.move_centre()
            elif action==5:
                joint_pos_traj = self.move_right_avanti()
            else: ## move left
                joint_pos_traj = self.move_left()

            print("joint pos traj: ", joint_pos_traj)
            if len(joint_pos_traj) > 0:
                self.cubic_spline_interpolation(joint_pos_traj)
            else:
                self.optimization_failed = True
                self.joint_trajectory = np.array([])

       if self.joint_trajectory is not None and len(self.joint_trajectory) > 0:
           temp = self.joint_trajectory[0][0]
           joint_pos_des = temp[0]
           joint_vel_des = temp[1]
           self.joint_trajectory = self.joint_trajectory[1:]
           self.last_cmd[1] = joint_vel_des
           self.last_cmd[0] = joint_pos_des
       else:
           self.last_cmd[1] = np.zeros(self.env_info['robot']['n_joints'])
           if not self.optimization_failed:
               time.sleep(0.01)
       return self.last_cmd


    def _plan_trajectory_thread(self, goal_pos, ee_pos, joint_pos, joint_vel):
       ##e_traj, hit_idx = self.plan_ee_trajectory(goal_pos, ee_pos, None)
        ee_traj = np.random(goal_pos, ee_pos)
        _, joint_pos_traj = self.optimizer.optimize_trajectory(ee_traj, joint_pos, joint_vel, None)
        print("joint pos traj: ", joint_pos_traj)
        if len(joint_pos_traj) > 0:
            self.cubic_spline_interpolation(joint_pos_traj)
        else:
            self.optimization_failed = True
            self.joint_trajectory = np.array([])
        self.has_planned=True



    def plan_ee_trajectory(self, puck_pos, ee_pos, t_plan):
        hit_dir_2d = np.array([0., np.sign(puck_pos[1])])

        hit_pos_2d = puck_pos[:2] - hit_dir_2d * (self.env_info['mallet']['radius'])

        start_pos_2d = ee_pos[:2]

        hit_vel = 0
        print("---------------------------------------------------------------------")
        print("defending agent: plan_ee_trajectory")
        print("-------------------------------------------------------------------------")
        self.bezier_planner.compute_control_point(start_pos_2d, np.zeros(2), hit_pos_2d, hit_dir_2d * hit_vel, t_plan)

        res = np.array([self.bezier_planner.get_point(t_i) for t_i in np.arange(0, self.bezier_planner.t_final + 1e-6,
                                                                                self.dt)])
        p = res[1:, 0].squeeze()
        dp = res[1:, 1].squeeze()
        ddp = res[1:, 2].squeeze()

        p = np.hstack([p, np.ones((p.shape[0], 1)) * self.ee_height])
        dp = np.hstack([dp, np.zeros((p.shape[0], 1))])
        ddp = np.hstack([ddp, np.zeros((p.shape[0], 1))])

        hit_traj = np.hstack([p, dp, ddp])

        last_point_2d = hit_traj[-1, :2]
        last_vel_2d = hit_traj[-1, 3:5]

        # Plan Return Trajectory
        stop_point = last_point_2d + hit_dir_2d * 0.1
        stop_point[1] = 0
        self.bezier_planner.compute_control_point(last_point_2d, last_vel_2d, stop_point, np.zeros(2), 1.5)

        res = np.array([self.bezier_planner.get_point(t_i) for t_i in np.arange(0, self.bezier_planner.t_final + 1e-6,
                                                                                self.dt)])
        p = res[1:, 0].squeeze()
        dp = res[1:, 1].squeeze()
        ddp = res[1:, 2].squeeze()

        p = np.hstack([p, np.ones((p.shape[0], 1)) * self.ee_height])
        dp = np.hstack([dp, np.zeros((p.shape[0], 1))])
        ddp = np.hstack([ddp, np.zeros((p.shape[0], 1))])
        return_traj = np.hstack([p, dp, ddp])

        ee_traj = np.vstack([hit_traj, return_traj])
        return ee_traj, len(hit_traj)



    def cubic_spline_interpolation(self, joint_pos_traj):
        joint_pos_traj = np.array(joint_pos_traj)
        t = np.linspace(1, joint_pos_traj.shape[0] + 1, joint_pos_traj.shape[0]) * 0.02

        f = CubicSpline(t, joint_pos_traj, axis=0)
        df = f.derivative(1)
        self.joint_trajectory = np.stack([f(t), df(t)]).swapaxes(0, 1)

    def get_joint_trajectory(self, ee_traj):
        init_q = self.last_cmd[0]
        joint_pos_traj = list()
        while len(ee_traj) > 0:
            ee_pos_des = ee_traj[0][:3]
            ee_traj = ee_traj[1:]
            success, joint_pos_des = inverse_kinematics(self.robot_model, self.robot_data,
                                                        ee_pos_des, initial_q=init_q)
            if not success:
                joint_pos_traj.clear()
                return joint_pos_traj
            init_q = joint_pos_des
            joint_pos_traj.append(joint_pos_des[:self.env_info['robot']['n_joints']])
        return joint_pos_traj
def main():
    from air_hockey_challenge.framework.air_hockey_challenge_wrapper import AirHockeyChallengeWrapper
    import matplotlib.pyplot as plt
    import matplotlib
    matplotlib.use("tkAgg")

    env = AirHockeyChallengeWrapper(env="3dof-defend", debug=True)

    agent = DefendingAgent(env.base_env.env_info)

    obs = env.reset()
    agent.reset()

    steps = 0
    while True:
        steps += 1
        action = agent.draw_action(obs)
        obs, reward, done, info = env.step(action)
        env.render()

        if done or steps > env.info.horizon / 2:
            nq = env.base_env.env_info['robot']['n_joints']
            if env.base_env.debug:
                trajectory_record = np.array(env.base_env.controller_record)
                fig, axes = plt.subplots(5, nq)
                nq_total = nq * env.base_env.n_agents
                for j in range(nq):
                    axes[0, j].plot(trajectory_record[:, j])
                    axes[0, j].plot(trajectory_record[:, j + nq_total])
                    axes[1, j].plot(trajectory_record[:, j + 2 * nq_total])
                    axes[1, j].plot(trajectory_record[:, j + 3 * nq_total])
                    axes[2, j].plot(trajectory_record[:, j + 4 * nq_total])
                    axes[3, j].plot(trajectory_record[:, j + 5 * nq_total])
                    axes[4, j].plot(trajectory_record[:, j + nq_total] - trajectory_record[:, j])
                plt.show()

            steps = 0
            obs = env.reset()
            agent.reset()


if __name__ == '__main__':
    main()
